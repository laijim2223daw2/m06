<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ca">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <title>Càlcul de temperatures mitjanes</title>
    </head>
    <body>
        <p>
            <b><u>APLICACIÓ PEL CÀLCUL DE TEMPERATURES MITJANES</u></b>
        </p>
        <b>a) Introudeix les dades de temperatura en ºC:<br /></b>
        <table>
            <tbody id="tbody">
                <tr>
                    <td>Mostra de Temperatura 1:</td>
                    <td>
                        <input
                            type="text"
                            name="temp[]"
                            size="5"
                            maxlength="6"
                            value="0"
                        />
                    </td>
                    <td>Mostra de Temperatura 2:</td>
                    <td>
                        <input
                            type="text"
                            name="temp[]"
                            size="5"
                            maxlength="6"
                            value="0"
                        />
                    </td>
                </tr>
                <tr>
                    <td>Mostra de Temperatura 3:</td>
                    <td>
                        <input
                            type="text"
                            name="temp[]"
                            size="5"
                            maxlength="6"
                            value="0"
                        />
                    </td>
                    <td>Mostra de Temperatura 4:</td>
                    <td>
                        <input
                            type="text"
                            name="temp[]"
                            size="5"
                            maxlength="6"
                            value="0"
                        />
                    </td>
                </tr>
                <tr>
                    <td>Mostra de Temperatura 5:</td>
                    <td>
                        <input
                            type="text"
                            name="temp[]"
                            size="5"
                            maxlength="6"
                            value="0"
                        />
                    </td>
                    <td>Mostra de Temperatura 6:</td>
                    <td>
                        <input
                            type="text"
                            name="temp[]"
                            size="5"
                            maxlength="6"
                            value="0"
                        />
                    </td>
                </tr>
                <tr>
                    <td>Mostra de Temperatura 7:</td>
                    <td>
                        <input
                            type="text"
                            name="temp[]"
                            size="5"
                            maxlength="6"
                            value="0"
                        />
                    </td>
                    <td>Mostra de Temperatura 8:</td>
                    <td>
                        <input
                            type="text"
                            name="temp[]"
                            size="5"
                            maxlength="6"
                            value="0"
                        />
                    </td>
                </tr>
            </tbody>
        </table>
        <br />
        <b>b) Escull les unitats de temperatura del resultat:</b><br />
        <input name="ut[]" value="celsius" type="checkbox" checked />Graus
        Celsius (ºC)<br />
        <input name="ut[]" value="fahrenheit" type="checkbox" />Graus Fahrenheit
        (ºF)<br />
        <input name="ut[]" value="kelvins" type="checkbox" />Kelvins (K)<br />
        <br />
        <button onclick="fCalcula()">Calcula mitjanes</button>
        <button onclick="fNeteja()">Neteja dades</button>
        <button onclick="addOne()">AÑADIR</button>
        <p><b>RESULTATS:</b></p>

        <p id="resultats"></p>

        <button onclick="fReinicia()">Neteja resultats</button>
        <button onclick="fNetejaReinicia()">Neteja reinicia</button>
        <script>
            
            function fCalcula() {
                /*
                    Fahrenheit ((9 * Celsius / 5)) + 32;
                    Kelvin = 273 + Celsius
                */

                const media = calcularMedia();

                let unidades = document.getElementsByName("ut[]");
                let html = "";

                Object.values(unidades).map( ( checkbox ) => {

                    if ( checkbox.checked ) {
                        const unidad = checkbox.value;
                        let valor = media;

                        switch ( unidad ) {

                            case 'fahrenheit':
                                valor = ((9 * media / 5)) + 32;
                                html += `<b>Fahrenheit:</b> ${ valor.toFixed(1) } <br/>`
                                break;

                            case 'kelvins':
                                valor = 273 + media;
                                html += `<b>Kelvins:</b> ${ valor.toFixed(1) } <br/>`
                                break;

                            case 'celsius':
                                html += `<b>Celsius:</b> ${ valor.toFixed(1) } <br/>`
                                break;

                        }

                    }

                });

                document.getElementById('resultats').innerHTML = html;

            }



            function fReinicia() {
                document.getElementById('resultats').innerHTML = "";
            }

            function fNeteja() {
                let temperaturas = document.getElementsByName("temp[]");

                Object.values(temperaturas).map((input) => {
                    input.value = 0;
                });
            }

            function fNetejaReinicia() {
                fNeteja();
                fReinicia();
            }

            /*** helpers ***/

            const calcularMedia = () => {
                let temperaturas = document.getElementsByName("temp[]");

                let total = 0;

                Object.values(temperaturas).map((input) => {
                    total += parseInt(input.value);
                });

                const media = total / temperaturas.length;
                return media;

            };


            const addOne = () => {

                document.getElementById('tbody').innerHTML += '<tr><td>Mostra de Temperatura 9:</td><td><input type="text"name="temp[]"size="5"maxlength="6"value="0"/></td><td>Mostra de Temperatura 10:</td><td><input type="text"name="temp[]"size="5"maxlength="6"value="0"/></td></tr>';

            }

        </script>
    </body>
</html>